package rsa_test

import (
	"testing"

	"github.com/jaspeen/apikeyman/algo"
	_ "github.com/jaspeen/apikeyman/algo/rsa"
	"github.com/jaspeen/apikeyman/algo/tests"
)

func TestSignVerify(t *testing.T) {
	t.Run("RS256", func(t *testing.T) {
		tests.RunSignVerifyTest(t, algo.GetSignAlgorithm("RS256"),
			`-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAh80vrAAYRAbw/bXTXhYa
7vFszyZPWanXm/36l1SajJtVq2i2KM8hKZom2dpNE4CKz5y3yuQj4wVW+o2K6jrM
hjXZmL80bNr4OD0CPcC6X3UMKohAOW3QTjk8WNQBhDRrPhRdF/ZKOQM5swevHIdE
4fIK0750kv7AlgPsYJ3O/bl1jkyjxhH80GC7C/wFlMZTZkBTL5+3W0dHKYZRRQWN
Jxl6PoVsU3FSRliShDNKzY7hxOZwGNdqn1ifQqY0UrLz5T+opph1fcmI4gun1U19
MwMOWMXOrCLf12sruf7ud1so+Mtjii4HLURUJqG1YbyI3PWvWOpHulh0vnFUArSf
3QIDAQAB
-----END PUBLIC KEY-----
`,
			`-----BEGIN PRIVATE KEY-----
MIIEvAIBADANBgkqhkiG9w0BAQEFAASCBKYwggSiAgEAAoIBAQCHzS+sABhEBvD9
tdNeFhru8WzPJk9Zqdeb/fqXVJqMm1WraLYozyEpmibZ2k0TgIrPnLfK5CPjBVb6
jYrqOsyGNdmYvzRs2vg4PQI9wLpfdQwqiEA5bdBOOTxY1AGENGs+FF0X9ko5Azmz
B68ch0Th8grTvnSS/sCWA+xgnc79uXWOTKPGEfzQYLsL/AWUxlNmQFMvn7dbR0cp
hlFFBY0nGXo+hWxTcVJGWJKEM0rNjuHE5nAY12qfWJ9CpjRSsvPlP6immHV9yYji
C6fVTX0zAw5Yxc6sIt/Xayu5/u53Wyj4y2OKLgctRFQmobVhvIjc9a9Y6ke6WHS+
cVQCtJ/dAgMBAAECggEABrTEPjssTO0G05CPZTMJlh5yoBwlM6lRI2aRtw1k1b1f
UqfzbuUjnxlPV9dm56f5CDLrWefq5G1sE9K6NxeQ6APFa2dDIH5ZCaCW+WkItb64
S2q6Y9ufZhgqJGd7wlqQUoV7lLut2KORzYcl8kO1IW9BcklnxPvdk3WSzlvx+nzZ
U1WFlfxIHIJqn7JO0h+KxRoABDKWhf+WrEZE7RqOyMxnRXA+bp1CnPb9CSAdP4eB
1NsEhXaH02D61BXegySYmDCNRryPvmzL61hnCm7jTp9MDYCkP5ahx+qJScNFG6m4
MlTMa93wSdJJS7hZJNLpEfJK6rZ0fkLyDnNHhYAt4QKBgQC6VoJ8keqvCoTWUE/5
y2vowoQGL2unSxi0V2vT7w9TlgACjrdShVIeIj5AgP+wNab45KEgR4ZN2+6C8qUc
hFCkSPH4l4jkMgRWgGR4dsue0ifrdxKpgK4CMQBkGeVvrl9404ewVwQnIe6sKUjV
BBLNZpeYKkdrfyEZIbGuJIgB6QKBgQC6khVVJez4wUFzIkXHdg58urg7G67Z1QE/
bouQIe1f0ux6u0KuSmOOWiJxAu0RdX1Ut0gTsEZHaAp1xYVUlPKPkXR2qSoAl+cT
8UAO8021VjwkDsJg+pt9tXlfALEJzHou3Nw6W9HgEDGGFK8btHx30LMVSIaayKRc
h7vTr2wh1QKBgCbDEjfZnsk01fdDE6/x2gu8Uvx6ZtmRLJ1vRhX7N+P6YxwlFguL
gk6UbwC6FPZR4t8JqF7vogeWRaJl2WT6PVA/gF5nH2ng4bgg00Wf6LGsI/O+fFpY
U1pPWTZ5kJnP2zpmPma3YzzEuUKFAAqX41VpDwXvXZYGBxuUP8LrBIPpAoGAfhck
m7taAHR7y1gqWLeM6vc2c5wt+8JdaYVIhUyopM5kTD4qvqg/yIFaLY6Qse/5mDuW
VtgXZ0MFbrrjdVqE5Eqlr1x8qpH+9hdh97ivmBKD6sqey/QTCk6PjIlnHPw4x1s0
66wKl6faEIgCIHNGe6NspMGzVwCrNG33nwU7y1ECgYA8iIFnWS5hNHCvo1rQ73Av
WOrL4b16QLGZQKtB67bCt+VWq9KH5zni/qUCmZTWvydd4VqJAIllIroxBES/lnxC
cvDRD8+7uorRlzMJKgDYmV5OFRki9OX6nUKfgObvo6q2532ASMW0ppznPDWYJ91e
U+K+yDdlvw+in27Y83Y4Sw==
-----END PRIVATE KEY-----			
`,
			"hSvFC6qMdlxRRwtDtlw3N0nDhUnrOm0ZcS+8VemB9LKujLO3+fFciAwrlQjQ2aUik+cY7wSPEascxNXdUt7gC/0tJrtvhAuXPnsStJuK7/ZMzbGAbq8hv1svEdBlnvNfQVTjm2uayOM2GO32sn73BoNML9Y1F0V4emOj3cmRLA1NfI+2XRyNfOnodoK1Hq1YMtrQIRc9ylrPNH+8nDbZfXBrMhnbA3f6fF2hIFz4y640+jgXJOSzxPorYvfS2nMCOGaZg+iHt/LK/+9tPnSIe+uTIrhqHamsS0G5L8sSFB3YvcFIrZfC7QbXZfFoWDNIDACrXhnXu0n4F2QWpuXXhA==",
			"test data")
	})
}
